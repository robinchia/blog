---
layout: post
title: "Ajax缓存解决办法 - 全哥 - 博客园"
categories: JS用法
tags: 
 - JS用法
--- 

# Ajax缓存解决办法 - 全哥 - 博客园

# [全哥](http://www.cnblogs.com/quange/)

## 不断学习,努力超越自己.

* [博客园](http://www.cnblogs.com/)
* [首页](http://www.cnblogs.com/quange/)
* [社区](http://space.cnblogs.com/)
* [新随笔](http://www.cnblogs.com/quange/admin/EditPosts.aspx?opt=1)
* [联系](http://space.cnblogs.com/msg/send/å¨å¥)
* [管理](http://www.cnblogs.com/quange/admin/EditPosts.aspx)
* [订阅](http://www.cnblogs.com/quange/rss) [![订阅]()](http://www.cnblogs.com/quange/rss)
随笔- 47  文章- 0  评论- 52 

# [Ajax缓存解决办法](http://www.cnblogs.com/quange/archive/2009/07/24/1529958.html)

转载一篇文章,在做聊天室的过程中困惑我很久的一个问题.呵呵,太感谢作者了.原文如下:

项目有时要用一些Ajax的效果，因为比较简单，也就没有去用什么Ajax.net之类的东西，手写代码也就实现了。、

第二天，有人向我报告错误；说是只有第一次读取的值正常，后面的值都不正常；我调试了一下 ，确实有这样的问题，查出是因为AJAX缓存的问题：解决办法有如下几种:

**      1、**在服务端加 header("Cache-Control: no-cache, must-revalidate");(如php中)

**2、**在ajax发送请求前加上 anyAjaxObj.setRequestHeader("If-Modified-Since","0");

**3、**在ajax发送请求前加上 anyAjaxObj.setRequestHeader("Cache-Control","no-cache");

**4、**在 Ajax 的 URL 参数后加上 "?fresh=" + Math.random(); //当然这里参数 fresh 可以任意取了

**5、**第五种方法和第四种类似，在 URL 参数后加上 "?timestamp=" + new Date().getTime();

**6、**用POST替代GET：不推荐

 

1、加个随机数
      xmlHttp.open("GET", "ajax.asp?now=" + new Date().getTime(), true);
2、在要异步获取的asp页面中写一段禁止缓存的代码：
      Response.Buffer =True
      Response.ExpiresAbsolute =Now() - 1
      Response.Expires=0
      Response.CacheControl="no-cache"

3、在ajax发送请求前加上xmlHTTP.setRequestHeader("If-Modified-Since","0");可以禁止缓存
      xmlHTTP.open("get", URL, true);
      xmlHTTP.onreadystatechange = callHTML;
      xmlHTTP.setRequestHeader("If-Modified-Since","0");
      xmlHTTP.send();

另一个作者写到:
AJAX的缓存是由浏览器维持的，对于发向服务器的某个url，ajax仅在第一次请求时与服务器交互信息，之后的请求中，ajax不再向服务器提交请求，而是直接从缓存中提取数据。
有些情况下，我们需要每一次都从服务器得到更新后数据。思路是让每次请求的url都不同，而又不影响正常应用：在url之后加入随机内容。
e.g.
url=url+"&"+Math.random();
Key points:
1.每次请求的url都不一样（ajax的缓存便不起作用）
2.不影响正常应用（最基本的）
----------------
方法二：（未经证实）
在JSP中禁止缓存
response.addHeader("Cache-Control", "no-cache");
response.addHeader("Expires", "Thu, 01 Jan 1970 00:00:01 GMT");
HTTP:
<META HTTP-EQUIV="pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-cache, must-revalidate">
<META HTTP-EQUIV="expires" CONTENT="Wed, 26 Feb 1997 08:21:57 GMT">
<META HTTP-EQUIV="expires" CONTENT="0">

另一个作者写到:

我们都知道，ajax能提高页面载入的速度的主要原因是通过ajax减少了重复数据的载入，真正做到按需获取，既然如此，我们在写ajax程序的时候不妨送佛送到西，在客户端再做一次缓存,进一步提高数据载入速度。那就是在载入数据的同时将数据缓存在浏览器内存中，一旦数据被载入，只要页面未刷新，该数据就永远的缓存在内存中，当用户再次查看该数据时，则不需要从服务器上去获取数据，极大的降低了服务器的负载和提高了用户的体验。

0

0
0

(请您对文章做出评价)
[«](http://www.cnblogs.com/quange/archive/2009/07/24/1529911.html)上一篇：[Yahoo!网站性能最佳体验的34条黄金守则(转载)](http://www.cnblogs.com/quange/archive/2009/07/24/1529911.html "发布于2009-07-24 09:53")
[»](http://www.cnblogs.com/quange/archive/2009/07/24/1529985.html)下一篇：[用YSlow分析我们页面(转载)](http://www.cnblogs.com/quange/archive/2009/07/24/1529985.html "发布于2009-07-24 10:50")

posted @ 2009-07-24 10:36 [全哥](http://www.cnblogs.com/quange/) 阅读(467) [评论(0)](http://www.cnblogs.com/quange/archive/2009/07/24/1529958.html#commentform)  [编辑](http://www.cnblogs.com/quange/admin/EditPosts.aspx?postid=1529958) [收藏](http://www.cnblogs.com/quange/AddToFavorite.aspx?id=1529958) [网摘](http://www.cnblogs.com/quange/archive/2009/07/24/1529958.html#) 所属分类: [WEB前端优化](http://www.cnblogs.com/quange/category/201264.html)
![]()

[刷新评论列表](http://www.cnblogs.com/quange/archive/2009/07/24/1529958.html###)  [刷新页面](http://www.cnblogs.com/quange/archive/2009/07/24/1529958.html###)  [返回页首](http://www.cnblogs.com/quange/archive/2009/07/24/1529958.html#top)

发表评论 [程序员招聘](http://job.cnblogs.com/)  [求职](http://home.cnblogs.com/job/applys/)  [IT新闻](http://news.cnblogs.com/)

昵称： [[登录]](http://passport.cnblogs.com/login.aspx?ReturnUrl=http%3a%2f%2fwww.cnblogs.com%2fquange%2farchive%2f2009%2f07%2f24%2f1529958.html%3flogin%3d1%23commentform) [[注册]](http://passport.cnblogs.com/register.aspx?ReturnUrl=http%3a%2f%2fwww.cnblogs.com%2fquange%2farchive%2f2009%2f07%2f24%2f1529958.html%23Top)

主页：

邮箱：(仅博主可见)

验证码： ![验证码]() [看不清，换一个](http://www.cnblogs.com/quange/archive/2009/07/24/1529958.html###)

评论内容：

  [登录](http://passport.cnblogs.com/login.aspx?ReturnUrl=http%3a%2f%2fwww.cnblogs.com%2fquange%2farchive%2f2009%2f07%2f24%2f1529958.html%3flogin%3d1%23commentform)  [注册](http://passport.cnblogs.com/register.aspx?ReturnUrl=http%3a%2f%2fwww.cnblogs.com%2fquange%2farchive%2f2009%2f07%2f24%2f1529958.html%23Bottom)

[使用Ctrl+Enter键快速提交评论]
0 1529958 rbEwnARW/cw=网站导航：[博客园首页](http://www.cnblogs.com/) | [个人主页](http://home.cnblogs.com/) | [闪存](http://home.cnblogs.com/ing/) | [IT新闻](http://news.cnblogs.com/) | [程序员招聘](http://job.cnblogs.com/) | [社区](http://space.cnblogs.com/) | [博问](http://space.cnblogs.com/q/) | [网摘](http://wz.cnblogs.com/)

IT新闻:
· [赛门铁克预测：2010年9大存储技术趋势](http://news.cnblogs.com/n/52390/)
· [雅虎重设北京研发中心 抛开阿里巴巴重新来过](http://news.cnblogs.com/n/52389/)
· [传闻Windows Mobile 7将搭载移动版IE7浏览器](http://news.cnblogs.com/n/52387/)
· [李彦宏：成功者是时刻播种梦想的人](http://news.cnblogs.com/n/52386/)
· [腾讯宣传图片证实联合运营网游：有望下周公布](http://news.cnblogs.com/n/52383/)
[China-pub 计算机图书网上专卖店！6.5万品种2-8折！](http://www.china-pub.com/itbook/)
[China-Pub 计算机绝版图书按需印刷服务](http://www.china-pub.com/static07/0901/zh_jueba_090121.asp)

链接：[切换模板](http://www.cnblogs.com/quange/archive/2009/07/24/1529958.html?switchskin=1#skinlist)
**相关搜索:**
[WEB前端优化](http://zzk.cnblogs.com/s?w=WEB%e5%89%8d%e7%ab%af%e4%bc%98%e5%8c%96)

**在知识库中查看：**
[Ajax缓存解决办法](http://kb.cnblogs.com/a/1529958/)

### 公告

[我的主页](http://home.cnblogs.com/quange/)  [个人资料](http://home.cnblogs.com/quange/detail/)
[我的闪存](http://home.cnblogs.com/quange/ing/)  [发短消息](http://space.cnblogs.com/msg/send/å¨å¥)

[<]( "Go to the previous month") 2009年7月 [>]( "Go to the next month") 日 一 二 三 四 五 六 28 29 30 1 2 3 [4](http://www.cnblogs.com/quange/archive/2009/7/4.html) 5 6 7 [8](http://www.cnblogs.com/quange/archive/2009/7/8.html) 9 10 [11](http://www.cnblogs.com/quange/archive/2009/7/11.html) 12 13 14 15 16 17 18 19 [20](http://www.cnblogs.com/quange/archive/2009/7/20.html) [21](http://www.cnblogs.com/quange/archive/2009/7/21.html) [22](http://www.cnblogs.com/quange/archive/2009/7/22.html) 23 [24](http://www.cnblogs.com/quange/archive/2009/7/24.html) 25 26 27 [28](http://www.cnblogs.com/quange/archive/2009/7/28.html) 29 30 [31](http://www.cnblogs.com/quange/archive/2009/7/31.html) 1 2 3 4 5 6 7 8
### 搜索

 

### 常用链接

* [我的随笔](http://www.cnblogs.com/quange/MyPosts.html)
* [我的空间](http://home.cnblogs.com/quange/)
* [我的短信](http://space.cnblogs.com/msg/recent)
* [我的评论](http://www.cnblogs.com/quange/MyComments.html)
* [更多链接](http://www.cnblogs.com/quange/archive/2009/07/24/1529958.html#)
* [我的参与](http://www.cnblogs.com/quange/OtherPosts.html "我发表过评论的随笔")
* [我的新闻](http://www.cnblogs.com/quange/MyNews.html)
* [最新评论](http://www.cnblogs.com/quange/RecentComments.html)
* [我的标签](http://www.cnblogs.com/quange/tag/)
### 我管理的小组

* [mssql专家组](http://space.cnblogs.com/group/mssql/)

### 我的标签

* [批量数据插入(1)](http://www.cnblogs.com/quange/tag/æ¹éæ°æ®æå¥/)
* [SqlBulkCopy(1)](http://www.cnblogs.com/quange/tag/SqlBulkCopy/)
* [数据库专家(1)](http://www.cnblogs.com/quange/tag/æ°æ®åºä¸å®¶/)
### 随笔分类(47)

* [LoadRunner(7)](http://www.cnblogs.com/quange/category/205053.html) [(rss)](http://www.cnblogs.com/quange/category/205053.html/rss "Subscribe to LoadRunner(7)")
* [mssql(10)](http://www.cnblogs.com/quange/category/191820.html) [(rss)](http://www.cnblogs.com/quange/category/191820.html/rss "Subscribe to mssql(10)")
* [Oracle10g(2)](http://www.cnblogs.com/quange/category/201907.html) [(rss)](http://www.cnblogs.com/quange/category/201907.html/rss "Subscribe to Oracle10g(2)")
* [WEB前端优化(5)](http://www.cnblogs.com/quange/category/201264.html) [(rss)](http://www.cnblogs.com/quange/category/201264.html/rss "Subscribe to WEB前端优化(5)")
* [工作心得(4)](http://www.cnblogs.com/quange/category/189283.html) [(rss)](http://www.cnblogs.com/quange/category/189283.html/rss "Subscribe to 工作心得(4)")
* [灰盒测试(7)](http://www.cnblogs.com/quange/category/205055.html) [(rss)](http://www.cnblogs.com/quange/category/205055.html/rss "Subscribe to 灰盒测试(7)")
* [软件测试(1)](http://www.cnblogs.com/quange/category/189286.html) [(rss)](http://www.cnblogs.com/quange/category/189286.html/rss "Subscribe to 软件测试(1)")
* [软件开发(4)](http://www.cnblogs.com/quange/category/189285.html) [(rss)](http://www.cnblogs.com/quange/category/189285.html/rss "Subscribe to 软件开发(4)")
* [推荐工具(7)](http://www.cnblogs.com/quange/category/192816.html) [(rss)](http://www.cnblogs.com/quange/category/192816.html/rss "Subscribe to 推荐工具(7)")

### 随笔档案(47)

* [2009年10月 (4)](http://www.cnblogs.com/quange/archive/2009/10.html)
* [2009年8月 (6)](http://www.cnblogs.com/quange/archive/2009/08.html)
* [2009年7月 (17)](http://www.cnblogs.com/quange/archive/2009/07.html)
* [2009年6月 (9)](http://www.cnblogs.com/quange/archive/2009/06.html)
* [2009年5月 (11)](http://www.cnblogs.com/quange/archive/2009/05.html)
### 最新评论[![]( "RSS订阅最最新评论")](http://www.cnblogs.com/quange/CommentsRSS.aspx "RSS订阅最最新评论")

[http://www.cnblogs.com/quange/archive/2009/06/26/1511643.html#1708953](http://www.cnblogs.com/quange/archive/2009/06/26/1511643.html#1708953)

ShopNum1网店系统 (ShopNum1网店系统)
[2. Re:千里眼淘宝版软件](http://www.cnblogs.com/quange/archive/2009/07/20/1527318.html#1671368)

是按所有宝贝前100个商品。 (全哥)
[3. Re:千里眼淘宝版软件](http://www.cnblogs.com/quange/archive/2009/07/20/1527318.html#1671083)

我试用了您的软件，给出的100个数据，似乎并不是30天销量的TOP100,而是随机的100个，然后按顺序排列。是么？ (pipidog28)
[4. Re:总结店铺密探开发](http://www.cnblogs.com/quange/archive/2009/06/18/1506005.html#1618879)

店铺密探单机版正式开发完成，软件介绍地址： (全哥)
[5. Re:千里眼淘宝版软件](http://www.cnblogs.com/quange/archive/2009/07/20/1527318.html#1610346)

呵呵，速度这么快，有开发一款系统。 (DQ)

### 阅读排行榜

* [1. 大数据量插入(2808)](http://www.cnblogs.com/quange/archive/2009/05/07/1451462.html)
* [2. 寻求执行sql时超时解决办法?(1424)](http://www.cnblogs.com/quange/archive/2009/05/18/1459287.html)
* [3. 千里眼淘宝版软件(741)](http://www.cnblogs.com/quange/archive/2009/07/20/1527318.html)
* [4. Ajax缓存解决办法(467)](http://www.cnblogs.com/quange/archive/2009/07/24/1529958.html)
* [5. loadrunner录制脚本时打不开IE解决办法（转）(356)](http://www.cnblogs.com/quange/archive/2009/08/06/1540115.html)
### 评论排行榜

* [1. 大数据量插入(17)](http://www.cnblogs.com/quange/archive/2009/05/07/1451462.html)
* [2. 寻求执行sql时超时解决办法?(10)](http://www.cnblogs.com/quange/archive/2009/05/18/1459287.html)
* [http://www.cnblogs.com/quange/archive/2009/06/26/1511643.html](http://www.cnblogs.com/quange/archive/2009/06/26/1511643.html)
* [4. 总结店铺密探开发(6)](http://www.cnblogs.com/quange/archive/2009/06/18/1506005.html)
* [5. 千里眼淘宝版软件(5)](http://www.cnblogs.com/quange/archive/2009/07/20/1527318.html)
Copyright ©2009 全哥
