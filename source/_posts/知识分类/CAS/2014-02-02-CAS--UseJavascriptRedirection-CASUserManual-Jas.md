---
layout: post
title: "Use Javascript Redirection - CAS User Manual - Jas"
categories: CAS
tags: 
 - CAS
--- 

# Use Javascript Redirection - CAS User Manual - Jasig Wiki

* [Skip to content](https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#title-heading)
* [Skip to breadcrumbs](https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#breadcrumbs)
* [Skip to header menu](https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#header-menu-bar)
* [Skip to action menu](https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#navigation)
* [Skip to quick search](https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#quick-search-query)
Quick Search

* [Browse](https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#)

* [Pages](https://wiki.jasig.org/pages/listpages.action?key=CASUM "Browse pages in the CAS User Manual space ( Type 'g' then 's' )")
* [Blog](https://wiki.jasig.org/pages/viewrecentblogposts.action?key=CASUM "Browse blogs in the CAS User Manual space")
* [Labels](https://wiki.jasig.org/labels/listlabels-heatmap.action?key=CASUM "Browse labels in the CAS User Manual space")
* [Attachments](https://wiki.jasig.org/spaces/listattachmentsforspace.action?key=CASUM "Browse attachments in the CAS User Manual space")
* [Mail](https://wiki.jasig.org/mail/archive/viewmailarchive.action?key=CASUM "Browse mail in the CAS User Manual space")
* [Advanced](https://wiki.jasig.org/spaces/viewspacesummary.action?key=CASUM "Browse additional space functions in the CAS User Manual space")
* [Activity](https://wiki.jasig.org/spaces/usage/report.action?key=CASUM)

* [What’s New](http://docs.atlassian.com/confluence/docs-41/whatsnew/iframe)
* [Space Directory](https://wiki.jasig.org/spacedirectory/view.action "Browse the Confluence space directory")
* [Feed Builder](https://wiki.jasig.org/dashboard/configurerssfeed.action "Create your custom RSS feed.")
* [Keyboard Shortcuts](https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection# "View available keyboard shortcuts ( Type '?' )")
* [Confluence Gadgets](https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection# "Browse gadgets provided by Confluence")
* [Log In](https://wiki.jasig.org/login.action?os_destination=%2Fdisplay%2FCASUM%2FUse%2BJavascript%2BRedirection)
* [Sign Up](https://wiki.jasig.org/signup.action)

1. [Dashboard](https://wiki.jasig.org/dashboard.action "Go to Dashboard ( Type 'g' then 'd' )")
1. [CAS User Manual](https://wiki.jasig.org/display/CASUM)
1. **…**
1. [Navigation](https://wiki.jasig.org/display/CASUM/Navigation)
1. [Advanced Topics](https://wiki.jasig.org/display/CASUM/Advanced+Topics)
1. [Use Javascript Redirection]()

* [Tools](https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#)

* [Attachments (0)](https://wiki.jasig.org/pages/viewpageattachments.action?pageId=12157004 "View Attachments ( Type 't' )")
* [Page History](https://wiki.jasig.org/pages/viewpreviousversions.action?pageId=12157004)
* [Restrictions](https://wiki.jasig.org/pages/viewinfo.action?pageId=12157004 "Edit restrictions")

* [Info](https://wiki.jasig.org/pages/viewinfo.action?pageId=12157004)
* [Link to this Page…](https://wiki.jasig.org/pages/viewinfo.action?pageId=12157004 "Link to this Page ( Type 'k' )")
* [View in Hierarchy](https://wiki.jasig.org/pages/listpages-dirview.action?key=CASUM&openId=12157004#selectedPageInHierarchy)
* [View Source](https://wiki.jasig.org/plugins/viewsource/viewpagesrc.action?pageId=12157004)

# [Use Javascript Redirection]()

[Skip to end of metadata](https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#page-metadata-end)

* [Page restrictions apply](https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection# "Page restrictions apply. Click the lock icon to view or edit the restriction.")
* Added by [Dale Ogilvie](https://wiki.jasig.org/display/~dale77), last edited by [Dale Ogilvie](https://wiki.jasig.org/display/~dale77) on Apr 30, 2008  ([view change](https://wiki.jasig.org/pages/diffpages.action?pageId=12157004&originalId=52495846))
* [show comment](https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#) [hide comment](https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#)
**Comment:** Corrected links that should have been relative instead of absolute.
[Go to start of metadata](https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#page-metadata-start)   Table of Contents

### [Home](https://wiki.jasig.org/display/CASUM/Home)

### [Overall Architecture](https://wiki.jasig.org/display/CASUM/Overall+Architecture)

* [Building and Deploying](https://wiki.jasig.org/display/CASUM/Building+and+Deploying)
* [Development](https://wiki.jasig.org/display/CASUM/Development)
* [Introduction](https://wiki.jasig.org/display/CASUM/Introduction)
* [Java Versions](https://wiki.jasig.org/display/CASUM/Java+Versions)
* [Releasing](https://wiki.jasig.org/display/CASUM/Releasing)
* [Spring Configuration](https://wiki.jasig.org/display/CASUM/Spring+Configuration)
* [Technical Overview](https://wiki.jasig.org/display/CASUM/Technical+Overview)
* [Upgrading](https://wiki.jasig.org/display/CASUM/Upgrading)

### [Authentication](https://wiki.jasig.org/display/CASUM/Authentication)

* [Active Directory](https://wiki.jasig.org/display/CASUM/Active+Directory)
* [Generic](https://wiki.jasig.org/display/CASUM/Generic)
* [JAAS](https://wiki.jasig.org/display/CASUM/JAAS)
* [JDBC](https://wiki.jasig.org/display/CASUM/JDBC)
* [LDAP](https://wiki.jasig.org/display/CASUM/LDAP)
* [Legacy](https://wiki.jasig.org/display/CASUM/Legacy)
* [RADIUS](https://wiki.jasig.org/display/CASUM/RADIUS)
* [SPNEGO](https://wiki.jasig.org/display/CASUM/SPNEGO)
* [Trusted](https://wiki.jasig.org/display/CASUM/Trusted)
* [X.509 Certificates](https://wiki.jasig.org/display/CASUM/X.509+Certificates)

### [Authentication Managers](https://wiki.jasig.org/display/CASUM/Authentication+Managers)

* [Default AuthenticationManager](https://wiki.jasig.org/display/CASUM/Default+AuthenticationManager)
* [Direct Mapping AuthenticationManager](https://wiki.jasig.org/display/CASUM/Direct+Mapping+AuthenticationManager)

### [Security Policy](https://wiki.jasig.org/display/CASUM/Security+Policy)

* [Ticket Expiration Policy](https://wiki.jasig.org/display/CASUM/Ticket+Expiration+Policy)
* [Remember Me](https://wiki.jasig.org/display/CASUM/Remember+Me)
* [Throttling Login Attempts](https://wiki.jasig.org/display/CASUM/Throttling+Login+Attempts)

### [TicketRegistry](https://wiki.jasig.org/display/CASUM/TicketRegistry)

* [BerkleyDB](https://wiki.jasig.org/display/CASUM/BerkleyDB)
* [Default](https://wiki.jasig.org/display/CASUM/Default)
* [EhcacheTicketRegistry](https://wiki.jasig.org/display/CASUM/EhcacheTicketRegistry)
* [JBOSS TreeCache](https://wiki.jasig.org/display/CASUM/JBOSS+TreeCache)
* [JDBCTicketRegistry](https://wiki.jasig.org/display/CASUM/JDBCTicketRegistry)
* [JpaTicketRegistry](https://wiki.jasig.org/display/CASUM/JpaTicketRegistry)
* [MemcacheTicketRegistry](https://wiki.jasig.org/display/CASUM/MemcacheTicketRegistry)
* [TicketRegistry Cleaner](https://wiki.jasig.org/display/CASUM/TicketRegistry+Cleaner)

### [Testing](https://wiki.jasig.org/display/CASUM/Testing)

* [Apache JMeter](https://wiki.jasig.org/display/CASUM/Apache+JMeter)
* [Java HttpComponents Based Test Class](https://wiki.jasig.org/display/CASUM/Java+HttpComponents+Based+Test+Class)
* [Nagios plugins](https://wiki.jasig.org/display/CASUM/Nagios+plugins)

### [Protocols](https://wiki.jasig.org/display/CASUM/Protocols)

* [Add Your Custom Protocol](https://wiki.jasig.org/display/CASUM/Add+Your+Custom+Protocol)
* [Applications that Require POST Responses](https://wiki.jasig.org/display/CASUM/Applications+that+Require+POST+Responses)
* [CAS](https://wiki.jasig.org/display/CASUM/CAS)
* [OAuth](https://wiki.jasig.org/display/CASUM/OAuth)
* [OpenID](https://wiki.jasig.org/display/CASUM/OpenID)
* [RESTful API](https://wiki.jasig.org/display/CASUM/RESTful+API)
* [SAML 1.1](https://wiki.jasig.org/display/CASUM/SAML+1.1)
* [SAML 2.0 (Google Accounts Integration)](https://wiki.jasig.org/pages/viewpage.action?pageId=6063484)
* [Single Sign Out](https://wiki.jasig.org/display/CASUM/Single+Sign+Out)

### [Advanced Topics](https://wiki.jasig.org/display/CASUM/Advanced+Topics)

* [Adding "Public Workstation" vs. "Private Workstation" Timeouts](https://wiki.jasig.org/pages/viewpage.action?pageId=13570204)
* [Auditing and Statistics Via Inspektr](https://wiki.jasig.org/display/CASUM/Auditing+and+Statistics+Via+Inspektr)
* [Internationalization](https://wiki.jasig.org/display/CASUM/Internationalization)
* [LDAP Password Policy Enforcement](https://wiki.jasig.org/display/CASUM/LDAP+Password+Policy+Enforcement)
* [Second-Level CAS Server](https://wiki.jasig.org/display/CASUM/Second-Level+CAS+Server)
* [Terracotta](https://wiki.jasig.org/display/CASUM/Terracotta)
* [Use Javascript Redirection]()
* [Deployment Scenarios](https://wiki.jasig.org/display/CASUM/Deployment+Scenarios)
* [Acceptable Use interface for Login Webflow](https://wiki.jasig.org/display/CASUM/Acceptable+Use+interface+for+Login+Webflow)
* [Change Password Integration With Jasig CAS 3.4.7](https://wiki.jasig.org/display/CASUM/Change+Password+Integration+With+Jasig+CAS+3.4.7)
* [Localization](https://wiki.jasig.org/display/CASUM/Localization)

### [Tutorials and HOWTOs](https://wiki.jasig.org/display/CASUM/Tutorials+and+HOWTOs)

* [CAS on Windows Quick Setup Guide](https://wiki.jasig.org/display/CASUM/CAS+on+Windows+Quick+Setup+Guide)
* [Clustering CAS](https://wiki.jasig.org/display/CASUM/Clustering+CAS)
* [Demo](https://wiki.jasig.org/display/CASUM/Demo)
* [HOWTO Configure JBoss for HTTPS](https://wiki.jasig.org/display/CASUM/HOWTO+Configure+JBoss+for+HTTPS)
* [HOWTO Configure Single Sign On Session Timeout](https://wiki.jasig.org/display/CASUM/HOWTO+Configure+Single+Sign+On+Session+Timeout)
* [HOWTO Setup Dual Authentication in CAS - SSL Client Auth and LDAP](https://wiki.jasig.org/display/CASUM/HOWTO+Setup+Dual+Authentication+in+CAS+-+SSL+Client+Auth+and+LDAP)
* [HOWTO Setup LDAP GSSAPI+Kerberos Authentication in CAS](https://wiki.jasig.org/pages/viewpage.action?pageId=10650669)
* [HOWTO Switch to Sun JVM in RHEL](https://wiki.jasig.org/display/CASUM/HOWTO+Switch+to+Sun+JVM+in+RHEL)
* [End-to-end Windows Example](https://wiki.jasig.org/display/CASUM/End-to-end+Windows+Example)
* [HOWTO Use Jasypt to encrypt passwords in configuration files](https://wiki.jasig.org/display/CASUM/HOWTO+Use+Jasypt+to+encrypt+passwords+in+configuration+files)
* [HOWTO utilize javax.servlet.http.HttpServletRequest isUserInRole( java.lang.String role )](https://wiki.jasig.org/pages/viewpage.action?pageId=47874068)
* [Migrating an existing CAS server installation](https://wiki.jasig.org/display/CASUM/Migrating+an+existing+CAS+server+installation)
* [Best Practice - Setting Up CAS Locally using the Maven2 WAR Overlay Method](https://wiki.jasig.org/display/CASUM/Best+Practice+-+Setting+Up+CAS+Locally+using+the+Maven2+WAR+Overlay+Method)
* [Deploying CAS 3.0.x in RHEL 5 with Sun Java](https://wiki.jasig.org/display/CASUM/Deploying+CAS+3.0.x+in+RHEL+5+with+Sun+Java)
* [HOWTO CASifying ASP.NET WebApp - ExampleWebsite](https://wiki.jasig.org/display/CASUM/HOWTO+CASifying+ASP.NET+WebApp+-+ExampleWebsite)
* [HOWTO Configure CAS for LDAP DIGEST-MD5](https://wiki.jasig.org/display/CASUM/HOWTO+Configure+CAS+for+LDAP+DIGEST-MD5)
* [HOWTO Run Canoo Web Tests](https://wiki.jasig.org/display/CASUM/HOWTO+Run+Canoo+Web+Tests)
* [Shibboleth-CAS Integration](https://wiki.jasig.org/display/CASUM/Shibboleth-CAS+Integration)

### [Troubleshooting](https://wiki.jasig.org/display/CASUM/Troubleshooting)

* [Logging](https://wiki.jasig.org/display/CASUM/Logging)
* [SSL Troubleshooting and Reference Guide](https://wiki.jasig.org/display/CASUM/SSL+Troubleshooting+and+Reference+Guide)

### [Services Management](https://wiki.jasig.org/display/CASUM/Services+Management)

* [Adding a New Service](https://wiki.jasig.org/display/CASUM/Adding+a+New+Service)
* [Attributes](https://wiki.jasig.org/display/CASUM/Attributes)
* [Configuring](https://wiki.jasig.org/display/CASUM/Configuring)
* [Deleting](https://wiki.jasig.org/display/CASUM/Deleting)
* [Editing](https://wiki.jasig.org/display/CASUM/Editing)

### [Extensions](https://wiki.jasig.org/display/CASUM/Extensions)

* [ClearPass](https://wiki.jasig.org/display/CASUM/ClearPass)
 When redirecting from the https CAS application back to an http service after authenticating successfully, IE6 presents the user with a security dialog saying "you are about to be redirected to a connection that is not secure, do you really want to do this?". We can avoid this by using javascript to perform the redirection in the client browser, instead of a server side redirect. This approach works fine for web pages, but does not work for protected image content, which will not execute the returned javascript, so we revert to a serverside redirect for this type of content.

1. Create WEB-INF/view/jsp/default/ui/redirect.jsp to perform the redirection using javascript
[?](https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#)<%

@page

import

=

"org.jasig.cas.authentication.principal.WebApplicationService"

%>

<%

@page

import

=

"org.jasig.cas.web.support.WebUtils"

%>
<%

@page

import

=

"java.net.URL"

%>

<%
WebApplicationService service = (WebApplicationService) request.getAttribute(

"service"

);

String ticket  = (String) request.getAttribute(

"serviceTicketId"

);
String redirectURL = service.getResponse(ticket).getUrl();

boolean

serverSideRedirect =

false

;
// if redirect is for an image, js or css file

URL url =

new

URL(redirectURL);
String path = url.getPath();

int

dotPos = path.lastIndexOf(

"."

);

// returns -1 if not found
if

( dotPos != -

1

)

{
    

String ext = path.substring(dotPos).toLowerCase();

    

serverSideRedirect =

".gif"

.equals(ext) ||

".jpg"

.equals(ext) ||

".png"

.equals(ext) ||

".js"

.equals(ext) ||

".css"

.equals(ext);
}

if

( serverSideRedirect )
{

    

// Serverside redirect using HTTP 302
    

response.sendRedirect(redirectURL);

}
else

{
    

// Client side redirect using javascript

%>
<!DOCTYPE html PUBLIC

"-//W3C//DTD XHTML 1.0 Transitional//EN"

"[http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"](http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd)

>

<html xmlns=

"[http://www.w3.org/1999/xhtml"](http://www.w3.org/1999/xhtml)

>
  

<head>

    

<script type=

"text/javascript"

language=

"javascript"

>
      

<!--

        

window.location.replace (

"<%=redirectURL%>"

);
      

-->

    

</script>
    

<title>Redirect</title>

  

</head>
  

<body></body>

</html>
<%

}
%>

2. Make a redirect view available to CAS by adding it to WEB-INF/classes/default_view.properties

[?](https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#)### Redirect view (logged in, javascript redirect to service)

redirectView.(

class

)=org.springframework.web.servlet.view.JstlView
redirectView.url=/WEB-INF/view/jsp/

default

/ui/redirect.jsp

 3. Modify WEB-INF/login-webflow.xml to make the redirect end state use the new view

[?](https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#)<end-state id=

"redirect"

view=

"redirectView"

/>

Labels:

None

[Edit Labels](https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection# "Edit Labels ( Type 'l' )")
Powered by a free **Atlassian Confluence Open Source Project License** granted to Java Architectures Special Interest Group. [Evaluate Confluence today](http://www.atlassian.com/c/conf/11461).
This Confluence installation runs a Free Gliffy License - [Evaluate Gliffy](http://www.gliffy.com/products/confluence-plugin/) for your Wiki!

* Powered by [Atlassian Confluence](http://www.atlassian.com/software/confluence) 4.1.5, the [Enterprise Wiki](http://www.atlassian.com/software/confluence/tour/enterprise-wiki.jsp)
* Printed by Atlassian Confluence 4.1.5, the Enterprise Wiki.
*  ·  [Report a bug](http://jira.atlassian.com/secure/BrowseProject.jspa?id=10470)
*  ·  [Atlassian News](http://www.atlassian.com/about/connected.jsp?s_kwcid=Confluence-stayintouch)

[]()[]()[]()
