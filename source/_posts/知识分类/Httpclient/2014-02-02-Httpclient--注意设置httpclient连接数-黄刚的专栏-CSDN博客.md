---
layout: post
title: "注意设置httpclient连接数 - 黄刚的专栏 - CSDN博客"
categories: Httpclient
tags: 
 - Httpclient
--- 

# 注意设置httpclient连接数 - 黄刚的专栏 - CSDN博客

# [黄刚的专栏](http://blog.csdn.net/lovingprince)

## No Complain ,Just Do It !

* [条新通知](http://hi.csdn.net/space-notice.html)
* [登录](http://passport.csdn.net/UserLogin.aspx)
* [注册](http://passport.csdn.net/CSDNUserRegister.aspx)
* [欢迎](http://hi.csdn.net/)
* [退出](http://writeblog.csdn.net/Signout.aspx)
* [我的博客](http://blog.csdn.net/)
* [配置](http://writeblog.csdn.net/configure.aspx)
* [写文章](http://writeblog.csdn.net/PostEdit.aspx)
* [文章管理](http://writeblog.csdn.net/PostList.aspx)
* [博客首页](http://blog.csdn.net/)

*
* 全站 当前博客
*

* [空间](http://hi.csdn.net/lovingprince)
* [博客](http://blog.csdn.net/lovingprince)
* [好友](http://hi.csdn.net/!s/friend/list/lovingprince)
* [相册](http://hi.csdn.net/!s/album/list/lovingprince)
* [留言](http://hi.csdn.net/!s/wall/to/lovingprince)

用户操作[[留言]](http://hi.csdn.net/!s/wall/to/lovingprince)  [[发消息]](http://hi.csdn.net/!s/msg/to/lovingprince)  [[加为好友]](http://hi.csdn.net/!s/friend/add/lovingprince) 订阅我的博客[![XML聚合]()](http://feeds.feedsky.com/csdn.net/lovingprince)   [![FeedSky]()](http://feeds.feedsky.com/csdn.net/lovingprince)[![订阅到鲜果]()](http://www.xianguo.com/subscribe.php?url=http://feeds.feedsky.com/csdn.net/lovingprince)[![订阅到Google]()](http://fusion.google.com/add?feedurl=http://feeds.feedsky.com/csdn.net/lovingprince)[![订阅到抓虾]()](http://www.zhuaxia.com/add_channel.php?url=http://feeds.feedsky.com/csdn.net/lovingprince)[[编辑]](http://writeblog.csdn.net/configure.aspx)lovingprince的公告权当备忘，分享经验点滴，不在乎内容是否简单，简单中其实更能体现出不平凡，不喜欢空谈的文章，更愿意实际一点，为需要的朋友做点贡献，如果能留下您宝贵的评价，相信您也可以让众多朋友受益，我分享，我快乐。
[![]()](http://s.click.taobao.com/t_1?i=qzvnpphF1HNGGA%3D%3D&p=mm_14667228_0_0&n=12) [《淘宝天下》12个月/52期 260元 送价值599元Black Rivet包](http://s.click.taobao.com/t_1?i=qzvnpphF1HNGGA%3D%3D&p=mm_14667228_0_0&n=12) 260.0元 [![]()](http://s.click.taobao.com/t_1?i=qzvnpphF1HNGGA%3D%3D&p=mm_14667228_0_0&n=12)
[![]()](http://s.click.taobao.com/t_1?i=qzvmMjgQtB0UgQ%3D%3D&p=mm_14667228_0_0&n=12) [《淘宝天下》6个月/26期 130元 送瑞士军刀旗舰店398元抵价券](http://s.click.taobao.com/t_1?i=qzvmMjgQtB0UgQ%3D%3D&p=mm_14667228_0_0&n=12) 130.0元 [![]()](http://s.click.taobao.com/t_1?i=qzvmMjgQtB0UgQ%3D%3D&p=mm_14667228_0_0&n=12)
[![]()](http://s.click.taobao.com/t_1?i=qzvmMjm%2Bgumi1Q%3D%3D&p=mm_14667228_0_0&n=12) [《淘宝天下》3个月/13期 65元 送OOPS服饰专营店118元抵价券](http://s.click.taobao.com/t_1?i=qzvmMjm%2Bgumi1Q%3D%3D&p=mm_14667228_0_0&n=12) 65.0元 [![]()](http://s.click.taobao.com/t_1?i=qzvmMjm%2Bgumi1Q%3D%3D&p=mm_14667228_0_0&n=12)[[编辑]](http://writeblog.csdn.net/EditCategories.aspx?catID=1)文章分类* [![(RSS)]()](http://blog.csdn.net/lovingprince/category/489565.aspx/rss)[Architecture](http://blog.csdn.net/lovingprince/category/489565.aspx "架构分析")
* [![(RSS)]()](http://blog.csdn.net/lovingprince/category/284705.aspx/rss)[Database](http://blog.csdn.net/lovingprince/category/284705.aspx "包含一些数据库处理心得")
* [![(RSS)]()](http://blog.csdn.net/lovingprince/category/289923.aspx/rss)[Design Pattern](http://blog.csdn.net/lovingprince/category/289923.aspx "设计模式")
* [![(RSS)]()](http://blog.csdn.net/lovingprince/category/267838.aspx/rss)[Java](http://blog.csdn.net/lovingprince/category/267838.aspx "包含一些基本的基础常识等")
* [![(RSS)]()](http://blog.csdn.net/lovingprince/category/601796.aspx/rss)[Linux](http://blog.csdn.net/lovingprince/category/601796.aspx "linux相关， 命令，安装等")
* [![(RSS)]()](http://blog.csdn.net/lovingprince/category/479430.aspx/rss)[Others](http://blog.csdn.net/lovingprince/category/479430.aspx "各种杂类文章")
* [![(RSS)]()](http://blog.csdn.net/lovingprince/category/604421.aspx/rss)[Project Management](http://blog.csdn.net/lovingprince/category/604421.aspx "项目管理")
* [![(RSS)]()](http://blog.csdn.net/lovingprince/category/289037.aspx/rss)[Structure&Arithmetic](http://blog.csdn.net/lovingprince/category/289037.aspx "数据结构与算法")
* [![(RSS)]()](http://blog.csdn.net/lovingprince/category/284725.aspx/rss)[Thinking](http://blog.csdn.net/lovingprince/category/284725.aspx "记录一些平时开发过程中得到的启示和想法等等<br />")
* [![(RSS)]()](http://blog.csdn.net/lovingprince/category/284704.aspx/rss)[Web](http://blog.csdn.net/lovingprince/category/284704.aspx "一些WEB处理技巧和方法")
* [![(RSS)]()](http://blog.csdn.net/lovingprince/category/490182.aspx/rss)[职场风云](http://blog.csdn.net/lovingprince/category/490182.aspx "职场的各大信息")[[编辑]](http://writeblog.csdn.net/EditLinks.aspx)代码质量[各类API查询](http://www.gotapi.com/html)[追求代码质量](http://www.ibm.com/developerworks/cn/java/j-cq/)[追求代码质量: 测试 Struts 遗留的应用程序](http://www.ibm.com/developerworks/cn/java/j-cq/)[追求代码质量: 谨防紧密耦合！](http://www.ibm.com/developerworks/cn/java/j-cq05227/index.html?S_TACT=105AGX52&amp;S_CMP=techcsdn)[[编辑]](http://writeblog.csdn.net/EditLinks.aspx)发表论文[结合混沌密码理论的彩色图象水印算法](http://www.ahcit.com/lanmuyd.asp?id=1972)[[编辑]](http://writeblog.csdn.net/EditLinks.aspx)技术文章[finally子句和try子句中return的先后关系，以及原理](http://www.cjsdn.net/post/view?bid=1&id=155312&age=0)[Hibernate包作用详解](http://www.elook.net.cn/cms/Site/Article/wlbch15/Java400/J2EEEJBJMS421/45129.html)[HSQLDB中文网站](http://hsqldb.bokee.com/)[Java 1.5被忽略了的小动作](http://dreamstone.javaeye.com/blog/77889)[Java XML API 漫谈](http://www.360doc.com/showweb/0/0/402740.aspx)[Java 核心技术专题](http://www.ibm.com/developerworks/cn/java/coretech/index.html?S_TACT=105AGX52&S_CMP=techcsdn)[JavaScript 打印web页面](http://ltc603.javaeye.com/blog/123191)[Java类加载内幕](http://searchwebservices.techtarget.com.cn/tips/362/2158862.shtml)[Java编程极限考验：ClassLoader类装载策略](http://www.jdon.com/jivejdon/thread/15456.html)[java调用dll](http://tvjody.javaeye.com/blog/125643)[JMX](http://www.itisedu.com/phrase/200604261751455.html)[maven文档](http://www.sonatype.com/)[Reactor模式和NIO](http://www.jdon.com/concurrent/reactor.htm)[Rope：理论与实践 为何以及何时使用 Ropes for Java 操纵字符串](http://www.ibm.com/developerworks/cn/java/j-ropes/?S_TACT=105AGX52&S_CMP=techcsdn)[Spring 系列: Spring 框架简介](http://www.ibm.com/developerworks/cn/java/wa-spring1/)[Struts 与 Velocity 的集成](http://www-128.ibm.com/developerworks/cn/java/j-sr1.html)[xdoclet](http://xdoclet.sourceforge.net/xdoclet/ant/xdoclet/modules/hibernate/HibernateDocletTask.html)[了解 Web 服务规范](http://www.ibm.com/developerworks/cn/webservices/understand/index.html?S_TACT=105AGX52&S_CMP=techcsdn)[使用 CAS 在 Tomcat 中实现单点登录](http://www-128.ibm.com/developerworks/cn/opensource/os-cn-cas/?S_TACT=105AGX52&S_CMP=techcsdn)[使用 Velocity 实现客户端和服务器端模板](http://www-128.ibm.com/developerworks/cn/java/j-velocity/)[使用spring2.5注释驱动的IOC功能](http://coolyongzi.javaeye.com/blog/192957)[初探Java类加载机制的奥秘（zz）](http://www.blogjava.net/hopeshared/archive/2006/10/23/76780.html)[在方法签名中使用控制反转（IoC）](http://www.ibm.com/developerworks/cn/java/j-ioc/index.html?S_TACT=105AGX52&S_CMP=techcsdn)[看看baidu是如何AJAX跨域的](http://www.cnblogs.com/passer/archive/2008/07/16/1243811.html)[认识 JsonML](http://www.ibm.com/developerworks/cn/xml/x-jsonml/index.html?S_TACT=105AGX52&S_CMP=techcsdn)[配置适用于正式使用环境下的Tomcat Web服务器双向SSL认证](http://thinkbase.net/w/main/Wiki?Tomcat5SSL_ServerAndClient)[[编辑]](http://writeblog.csdn.net/EditLinks.aspx)设计模式[Java 设计模式与建模专题](http://www.ibm.com/developerworks/cn/java/design/?S_TACT=105AGX52&amp;S_CMP=tec-csdn)[jive的设计模式-jive源代码研究2](http://hqmank.blog.bokee.net/bloggermodule/blog_viewblog.do?id=472499)[设计模式(Patterns in Java)](http://www.jdon.com/designpatterns/index.htm)[设计模式学习笔记-写得很好](http://www.cnblogs.com/kid-li/category/44668.html?Show=All)[[编辑]](http://writeblog.csdn.net/EditLinks.aspx)系统架构[Lessons from Internet Services: ACID vs. BASE](http://www.ccs.neu.edu/groups/IEEE/ind-acad/brewer/index.htm)[与冯大辉谈数据库架构](http://www.infoq.com/cn/interviews/fengdahui-database-architecture)[互联网开放平台技术趋势和讨论](http://www.infoq.com/cn/articles/Qclub-on-open-platform)[分布式系统中的一致性和可用性](http://www.infoq.com/cn/articles/distributed-sys-usability)[可伸缩性最佳实践：来自eBay的经验](http://www.infoq.com/cn/articles/ebay-scalability-best-practices)[构建的可伸缩性和达到的性能](http://www.infoq.com/cn/articles/scalability-panel)[牺牲一致性来换取分布式架构的可伸缩性](http://www.infoq.com/cn/news/2008/03/ebaybase)[谈InfoQ.com网站架构](http://www.infoq.com/cn/interviews/popescu-infoq-architecture-cn)[高伸缩性网站架构分析](http://highscalability.com/)存档* [2010年01月(1)](http://blog.csdn.net/lovingprince/archive/2010/01.aspx)
* [2009年12月(4)](http://blog.csdn.net/lovingprince/archive/2009/12.aspx)
* [2009年11月(1)](http://blog.csdn.net/lovingprince/archive/2009/11.aspx)
* [2009年10月(5)](http://blog.csdn.net/lovingprince/archive/2009/10.aspx)
* [2009年09月(5)](http://blog.csdn.net/lovingprince/archive/2009/09.aspx)
* [2009年07月(2)](http://blog.csdn.net/lovingprince/archive/2009/07.aspx)
* [2009年06月(4)](http://blog.csdn.net/lovingprince/archive/2009/06.aspx)
* [2009年05月(1)](http://blog.csdn.net/lovingprince/archive/2009/05.aspx)
* [2009年04月(2)](http://blog.csdn.net/lovingprince/archive/2009/04.aspx)
* [2009年03月(5)](http://blog.csdn.net/lovingprince/archive/2009/03.aspx)
* [2009年02月(4)](http://blog.csdn.net/lovingprince/archive/2009/02.aspx)
* [2009年01月(5)](http://blog.csdn.net/lovingprince/archive/2009/01.aspx)
* [2008年12月(7)](http://blog.csdn.net/lovingprince/archive/2008/12.aspx)
* [2008年11月(14)](http://blog.csdn.net/lovingprince/archive/2008/11.aspx)
* [2008年10月(4)](http://blog.csdn.net/lovingprince/archive/2008/10.aspx)
* [2008年09月(5)](http://blog.csdn.net/lovingprince/archive/2008/09.aspx)
* [2008年08月(6)](http://blog.csdn.net/lovingprince/archive/2008/08.aspx)
* [2008年07月(8)](http://blog.csdn.net/lovingprince/archive/2008/07.aspx)
* [2008年06月(7)](http://blog.csdn.net/lovingprince/archive/2008/06.aspx)
* [2008年05月(8)](http://blog.csdn.net/lovingprince/archive/2008/05.aspx)
* [2008年04月(2)](http://blog.csdn.net/lovingprince/archive/2008/04.aspx)
* [2008年03月(3)](http://blog.csdn.net/lovingprince/archive/2008/03.aspx)
* [2008年02月(1)](http://blog.csdn.net/lovingprince/archive/2008/02.aspx)
* [2008年01月(1)](http://blog.csdn.net/lovingprince/archive/2008/01.aspx)
* [2007年12月(9)](http://blog.csdn.net/lovingprince/archive/2007/12.aspx)
* [2007年11月(3)](http://blog.csdn.net/lovingprince/archive/2007/11.aspx)
* [2007年10月(2)](http://blog.csdn.net/lovingprince/archive/2007/10.aspx)
* [2007年09月(3)](http://blog.csdn.net/lovingprince/archive/2007/09.aspx)
* [2007年08月(5)](http://blog.csdn.net/lovingprince/archive/2007/08.aspx)
* [2007年06月(7)](http://blog.csdn.net/lovingprince/archive/2007/06.aspx)
* [2007年05月(6)](http://blog.csdn.net/lovingprince/archive/2007/05.aspx)
* [2007年04月(20)](http://blog.csdn.net/lovingprince/archive/2007/04.aspx)
* [2007年03月(22)](http://blog.csdn.net/lovingprince/archive/2007/03.aspx)
* [2007年02月(2)](http://blog.csdn.net/lovingprince/archive/2007/02.aspx)
* [2006年12月(1)](http://blog.csdn.net/lovingprince/archive/2006/12.aspx)
# ![原创]()  注意设置httpclient连接数 [收藏]( "收藏到我的网摘中，并分享给我的朋友")

在使用Httpclient的过程中，线上的酒店出现过一个问题，就是当访问量增大的时候，会发现本地的连接等待时间急剧增加，例如从400ms增加到 78000ms，之前一直以为是航信系统问题，后面经过检查才发现，原来是本地httpclient设置时，最大连接数采用了默认设置的原因，而默认的最大连接数只有2个，所以当有大量连接需要建立时，大多数连接只有等待。后面将连接数设置修改成32个之后，这个响应时间就基本上很少出现很大的时候。

      HttpConnectionManager httpConnectionManager = new MultiThreadedHttpConnectionManager();
        HttpConnectionManagerParams params = httpConnectionManager.getParams();
        params.setConnectionTimeout(5000);
        params.setSoTimeout(20000);
        params.setDefaultMaxConnectionsPerHost(32);//very important!!
        params.setMaxTotalConnections(256);//very important!!
        this.client = new HttpClient(httpConnectionManager);
        // 设置编码
        this.client.getParams().setContentCharset(CharsetHelper.GBK);
        this.client.getParams().setHttpElementCharset(CharsetHelper.GBK);

我们一般很容易注意到设置超时时间，例如这里的红色部分，但是极有可能忘记设置每个主机的最大连接数(绿色)，因此大家注意一下，本来是最简单的，但也最容易被忽略。

发表于 @ 2009年09月03日　18:39:00 | [评论( loading...  )](http://blog.csdn.net/lovingprince/archive/2009/09/03/4516532.aspx#FeedBack "评论")| [编辑](http://writeblog.csdn.net/PostEdit.aspx?entryId=4516532 "编辑")| [举报](mailto:webmaster@csdn.net?subject=Article Report!!!&body=Author:lovingprinceURL:http://blog.csdn.net/ArticleContent.aspx?UserName=lovingprince&Entryid=4516532)| [收藏]( "收藏到我的网摘中，并分享给我的朋友")

### [旧一篇:java 类加载器体系结构](http://blog.csdn.net/lovingprince/archive/2009/07/02/4317069.aspx) | [新一篇:Jboss as 基本设置](http://blog.csdn.net/lovingprince/archive/2009/09/03/4516537.aspx)

[查看最新精华文章 请访问博客首页](http://blog.csdn.net/)相关文章[]()

* 发表评论
 
* 表 情：
* [![顶]( "顶")](http://blog.csdn.net/lovingprince/archive/2009/09/03/4516532.aspx#) [![砸]( "砸")](http://blog.csdn.net/lovingprince/archive/2009/09/03/4516532.aspx#) [![棒]( "棒")](http://blog.csdn.net/lovingprince/archive/2009/09/03/4516532.aspx#) [![大笑]( "大笑")](http://blog.csdn.net/lovingprince/archive/2009/09/03/4516532.aspx#) [![愤怒]( "愤怒")](http://blog.csdn.net/lovingprince/archive/2009/09/03/4516532.aspx#) [![大哭]( "大哭")](http://blog.csdn.net/lovingprince/archive/2009/09/03/4516532.aspx#) [![疑问]( "疑问")](http://blog.csdn.net/lovingprince/archive/2009/09/03/4516532.aspx#) [![汗]( "汗")](http://blog.csdn.net/lovingprince/archive/2009/09/03/4516532.aspx#) [![呕吐]( "呕吐")](http://blog.csdn.net/lovingprince/archive/2009/09/03/4516532.aspx#) [![送花]( "送花")](http://blog.csdn.net/lovingprince/archive/2009/09/03/4516532.aspx#)

* 评论内容：
*
* 用 户 名：
* [登录]() [注册](http://passport.csdn.net/CSDNUserRegister.aspx) 匿名评论

* 验 证 码：
* [![验证码]()]() [重新获得验证码]()

*
* [![]()](http://blog.csdn.net/lovingprince/archive/2009/09/03/4516532.aspx#)

Copyright © lovingprincePowered by CSDN Blog![]()
