---
layout: post
title: "Oracle数据库中分区表的操作方法2"
categories: DB
tags: 
 - DB
 - 分区
--- 

# Oracle数据库中分区表的操作方法2

[通行证](http://reg.163.com/)：用户名  密码 [](http://mail.163.com/)[首页](http://www.163.com/) - [新闻](http://news.163.com/) - [免费邮箱](http://www.126.com/) - [短信](http://sms.163.com/) - [POPO](http://popo.163.com/) - [相册](http://photo.163.com/) - [搜索](http://so.163.com/) - [交友](http://love.163.com/) - [拍卖](http://adfarm.mediaplex.com/ad/ck/4080-25846-9511-15?cn=netease;textlink;hp) [![NetEase]()](http://www.163.com/)
 [新闻](http://news.163.com/) | [体育](http://sports.163.com/) | [财经](http://finance.163.com/) | [娱乐](http://ent.163.com/) | [商业](http://biz.163.com/)| [**科技**](http://tech.163.com/) | [汽车](http://auto.163.com/) | [数码](http://digi.163.com/) | [女人](http://lady.163.com/) | [旅游](http://travel.163.com/) | [教育](http://education.163.com/) | [文化](http://culture.163.com/) | [广州](http://gz.163.com/) | [军事](http://news.163.com/war/) | [部落](http://bulo.163.com/)
[评论](http://talk.163.com/) | [NBA](http://sports.163.com/nba/) | [明星](http://ent.163.com/people/) | [证券](http://stock.163.com/) | [基金](http://fund.163.com/) | [探索](http://tech.163.com/discover/) | [房产](http://soufun.163.com/) | [手机](http://mobile.163.com/) | [两性](http://health.163.com/sex/) | [健康](http://health.163.com/) | [培训](http://px.163.com/) | [电影](http://ent.163.com/ent/level1/movie.html) | [游戏](http://game.163.com/)| [拍卖](http://adfarm.mediaplex.com/ad/ck/4080-25838-9511-9?cn=netease;2word;hp) | [论坛](http://bbs.163.com/)  [![网易学院·教程]()](http://tech.163.com/school/) ·[工具软件](http://tech.163.com/special/t/000915AD/tools.html)·[办公软件](http://tech.163.com/special/o/000915A6/officetool.html)·[操作系统](http://tech.163.com/special/O/000915A0/OS.html)·[图形图像](http://tech.163.com/special/p/0009158A/photos.html)·[网站建设](http://tech.163.com/special/w/0009158K/website.html)·[编程开发](http://tech.163.com/special/d/0009159F/developer.html)·[多媒体](http://tech.163.com/special/m/0009158R/multimedia.html)·[网络](http://tech.163.com/special/n/000917GE/net.html)·[病毒](http://tech.163.com/special/d/000917GF/du.html) ·[学院首页](http://tech.163.com/school)·[精选专题](http://tech.163.com/special/S/000915SN/S_Special.html)·[艺术设计](http://tech.163.com/special/A/00091593/Arts1.html)·[电子杂志](http://tech.163.com/special/E/00091ESS/Ebook.html)·[教授视点](http://tech.163.com/special/S/000915AH/S_InterView.html)·[教授名录](http://tech.163.com/special/A/000915AH/AllPro1.html)·[软件新闻](http://tech.163.com/special/s/000915AS/softnews.html)·[论坛](http://tech.163.com/special/s/000917D5/schoolbbs.html)

你现在的位置是： [网易](http://www.163.com/) > [网易科技](http://tech.163.com/) > [网易学院·教程](http://tech.163.com/school)
# Oracle数据库中分区表的操作方法

http://tech.163.com/school · 2005-06-16 11:44:19 · 来源: blog

第1页：Oracle数据库中分区表的操作方法 第2页：Oracle数据库中分区表的操作方法
1.2.2. 查询分区表记录：

SQL> select * from dinya_test partition(part_01);    TRANSACTION_ID ITEM_ID ITEM_DESCRIPTION TRANSACTION_DATE    --------------------------------------------------------------------------------    1 12 BOOKS 2005-1-14 14:19:    2 12 BOOKS 2005-2-13 14:19:    SQL>    SQL> select * from dinya_test partition(part_02);    TRANSACTION_ID ITEM_ID ITEM_DESCRIPTION TRANSACTION_DATE    --------------------------------------------------------------------------------    3 12 BOOKS 2006-5-30    4 12 BOOKS 2007-6-23    SQL>    SQL> select * from dinya_test partition(part_03);    TRANSACTION_ID ITEM_ID ITEM_DESCRIPTION TRANSACTION_DATE    --------------------------------------------------------------------------------    5 12 BOOKS 2011-2-26    6 12 BOOKS 2011-4-30    SQL>
从查询的结果可以看出，插入的数据已经根据交易时间范围存储在不同的分区中。这里是指定了分区的查询，当然也可以不指定分区，直接执行select * from dinya_test查询全部记录。
在也检索的数据量很大的时候，指定分区会大大提高检索速度。
1.2.3. 更新分区表的记录：

SQL> update dinya_test partition(part_01) t set t.item_description=’DESK’ where    t.transaction_id=1;    1 row updated.    SQL> commit;    Commit complete.    SQL>
这里将第一个分区中的交易ID=1的记录中的item_description字段更新为“DESK”，可以看到已经成功更新了一条记录。但是当更新的时候指定了分区，而根据查询的记录不在该分区中时，将不会更新数据，请看下面的例子：

SQL> update dinya_test partition(part_01) t set t.item_description=’DESK’ where    t.transaction_id=6;    0 rows updated.    SQL> commit;    Commit complete.    SQL>
指定了在第一个分区中更新记录，但是条件中限制交易ID为6，而查询全表，交易ID为6的记录在第三个分区中，这样该条语句将不会更新记录。
1.2.4. 删除分区表记录：

SQL> delete from dinya_test partition(part_02) t where t.transaction_id=4;    1 row deleted.    SQL> commit;    Commit complete.    SQL>
上面例子删除了第二个分区part_02中的交易记录ID为4的一条记录，和更新数据相同，如果指定了分区，而条件中的数据又不在该分区中时，将不会删除任何数据。
**1.3. 分区表索引的使用：**
分区表和一般表一样可以建立索引，分区表可以创建局部索引和全局索引。当分区中出现许多事务并且要保证所有分区中的数据记录的唯一性时采用全局索引。
1.3.1. 局部索引分区的建立：

SQL> create index dinya_idx_t on dinya_test(item_id)    2 local    3 (    4 partition idx_1 tablespace dinya_space01,    5 partition idx_2 tablespace dinya_space02,    6 partition idx_3 tablespace dinya_space03    7 );    Index created.    SQL>
看查询的执行计划，从下面的执行计划可以看出，系统已经使用了索引：

SQL> select * from dinya_test partition(part_01) t where t.item_id=12;    Execution Plan    ----------------------------------------------------------    0 SELECT STATEMENT Optimizer=CHOOSE (Cost=2 Card=1 Bytes=187)    1 0 TABLE ACCESS (BY LOCAL INDEX ROWID) OF ’DINYA_TEST’ (Cost=    2 Card=1 Bytes=187)    2 1 INDEX (RANGE SCAN) OF ’DINYA_IDX_T’ (NON-UNIQUE) (Cost=1    Card=1)    Statistics    ----------------------------------------------------------    0 recursive calls    0 db block gets    4 consistent gets    0 physical reads    0 redo size    334 bytes sent via SQL*Net to client    309 bytes received via SQL*Net from client    2 SQL*Net roundtrips to/from client    1 sorts (memory)    0 sorts (disk)    2 rows processed    SQL>
1.3.2. 全局索引分区的建立
全局索引建立时global 子句允许指定索引的范围值，这个范围值为索引字段的范围值：

SQL> create index dinya_idx_t on dinya_test(item_id)    2 global partition by range(item_id)    3 (    4 partition idx_1 values less than (1000) tablespace dinya_space01,    5 partition idx_2 values less than (10000) tablespace dinya_space02,    6 partition idx_3 values less than (maxvalue) tablespace dinya_space03    7 );    Index created.    SQL>
本例中对表的item_id字段建立索引分区，当然也可以不指定索引分区名直接对整个表建立索引，如：

SQL> create index dinya_idx_t on dinya_test(item_id);    Index created.    SQL>
同样的，对全局索引根据执行计划可以看出索引已经可以使用：

SQL> select * from dinya_test t where t.item_id=12;    Execution Plan    ----------------------------------------------------------    0 SELECT STATEMENT Optimizer=CHOOSE (Cost=2 Card=3 Bytes=561)    1 0 TABLE ACCESS (BY GLOBAL INDEX ROWID) OF ’DINYA_TEST’ (Cost    =2 Card=3 Bytes=561)    2 1 INDEX (RANGE SCAN) OF ’DINYA_IDX_T’ (NON-UNIQUE) (Cost=1    Card=3)    Statistics    ----------------------------------------------------------    5 recursive calls    0 db block gets    10 consistent gets    0 physical reads    0 redo size    420 bytes sent via SQL*Net to client    309 bytes received via SQL*Net from client    2 SQL*Net roundtrips to/from client    3 sorts (memory)    0 sorts (disk)    5 rows processed    SQL>
**1.4. 分区表的维护：**
了解了分区表的建立、索引的建立、表和索引的使用后，在应用的还要经常对分区进行维护和管理。日常维护和管理的内容包括：增加一个分区，合并一个分区及删除分区等等。下面以范围分区为例说明增加、合并、删除分区的一般操作：
1.4.1. 增加一个分区:

SQL> alter table dinya_test    2 add partition part_04 values less than(to_date(’2012-01-01’,’yyyy-mm-dd’))    tablespace dinya_spa    ce03;    Table altered.    SQL>
增加一个分区的时候，增加的分区的条件必须大于现有分区的最大值，否则系统将提示ORA-14074 partition bound must collate higher than that of the last partition 错误。
1.4.2. 合并一个分区：

SQL> alter table dinya_test merge partitions part_01,part_02 into partition part_02;    Table altered.    SQL>
在本例中将原有的表的part_01分区和part_02分区进行了合并，合并后的分区为part_02,如果在合并的时候把合并后的分区定为part_01的时候，系统将提示ORA-14275 cannot reuse lower-bound partition as resulting partition 错误。
1.4.3. 删除分区：

SQL> alter table dinya_test drop partition part_01;    Table altered.    SQL>
删除分区表的一个分区后，查询该表的数据时显示，该分区中的数据已全部丢失，所以执行删除分区动作时要慎重，确保先备份数据后再执行，或将分区合并。
**1.5. 总结：**
需要说明的是，本文在举例说名分区表事务操作的时候，都指定了分区，因为指定了分区，系统在执行的时候则只操作该分区的记录，提高了数据处理的速度。不要指定分区直接操作数据也是可以的。在分区表上建索引及多索引的使用和非分区表一样。此外，因为在维护分区的时候可能对分区的索引会产生一定的影响，可能需要在维护之后重建索引，相关内容请参考分区表索引部分的文档

![落叶秋客]() [[返回首页]](http://tech.163.com/)

[![]()](http://tech.163.com/05/0616/11/1MC8AUT900091589.html) [[1](http://tech.163.com/05/0616/11/1MC8AUT900091589.html)] [2] [![]()](http://tech.163.com/05/0616/11/1MC8AUT900091589.html)
**相关文章：**

* ·[Oracle数据库集中复制方法浅议](http://tech.163.com/05/0610/11/1LSQ9ANG00091589.html)(2005-06-10 11:50:09)
* ·[Oracle中使用PL/SQL操作COM对象](http://tech.163.com/05/0608/11/1LNJOGMA00091589.html)(2005-06-08 11:19:55)
* ·[Oracle平台应用数据库系统的设计与开发](http://tech.163.com/05/0607/15/1LLF6ODF00091589.html)(2005-06-07 15:21:49)
* ·[Oracle与SQL Server在企业应用中的比较](http://tech.163.com/05/0606/10/1LIAGLN000091589.html)(2005-06-06 10:02:08)
* ·[SUN与Oracle牵手对抗SAP和IBM信息化巨头](http://tech.163.com/05/0420/08/1HP5LHI6000915DD.html)(2005-04-20 08:49:19)

**推荐文章：**

·[赢在2007赛迪网年度企业人物榜单揭晓](http://tech.163.com/08/0117/13/42DNAAL500091589.html) ·[你最需要哪种类型的视频教程](http://tech.163.com/08/0111/14/41UC892E00091589.html) ·[不用网银也网上购物 三步自助开通](http://tech.163.com/07/1206/14/3V1M3KJA00091589.html) ·[2007年UPA用户体验大会成功闭幕](http://tech.163.com/07/1204/09/3US0INJ500091589.html) ·[2007中国青年设计节暨用户体验年会在京开幕](http://tech.163.com/07/1124/10/3U2B680L00091589.html) ·[User Friendly 2007现场图片](http://tech.163.com/07/1123/14/3U07BF3000091589.html) ·[手机畅游互联网 空中Opera 2.0实测](http://tech.163.com/07/1120/15/3TOJAKSS00091589.html) ·[动易软件即将全面开源和免费](http://tech.163.com/07/1120/10/3TO3Q38200091589.html) ·[搜图有“道” 图片达人的搜索秘籍](http://tech.163.com/07/0830/17/3N5MP1KG000917GR.html) ·[数字水墙 08年世博会亮相](http://tech.163.com/07/0827/15/3MTMJAC60009159C.html) ·[RabbitAir MinusA2空气净化器设计](http://tech.163.com/07/0827/14/3MTLTCQM00091599.html) ·[Oscar Bjarnason 平面设计](http://tech.163.com/07/0827/14/3MTL6T860009159B.html) ·[国产杀毒软件半个月内勇夺两项国际权威认证](http://tech.163.com/07/0827/12/3MTDSFIV00091JFM.html) ·[美化你的博客-推荐多个博客图标下载网站](http://tech.163.com/07/0827/11/3MT9FRH900092A5O.html) ·[微软回应Vista用户遇到的网络问题“设计如此”](http://tech.163.com/07/0827/11/3MT8N9K6000920O4.html) ·[eBay改进用户体验 借鉴亚马逊页面设计搜索功能](http://tech.163.com/07/0827/10/3MT8ALLD000918BL.html) ·[极点五笔6.0正式版发布](http://tech.163.com/07/0827/10/3MT86E56000915AS.html) ·[WPS Office 2007抢先试用](http://tech.163.com/07/0827/10/3MT5KT0J000915AC.html) ·[报告称Google Apps功能远不及微软Office](http://tech.163.com/07/0827/10/3MT5A8I4000915AS.html) ·[什么是SOCK5代理，什么是HTTP代理](http://tech.163.com/07/0827/10/3MT55K55000917GE.html)
[]() 最新评论[]() [![]()](http://comment.news.163.com/reply/post.jsp?board=tech_bbs&threadid=1MC8AUT900091589)   ![]() **[更多评论](http://comment.news.163.com/reply/post.jsp?type=re&board=tech_bbs&threadid=1MC8AUT900091589)** 共 ***0***条评论 网易通行证：  　 密码：  　 　      参与评论   您的发表的评论将在5分钟内被审核，请耐心等待

网易学院联系电话：020-61210163-560 合作/投稿邮箱：NeteaseSchool(at)126.com

合作媒体：[结绳记事](http://www.isblog.cn/) [艺网](http://www.arthtml.com/) [中国电脑救援中心](http://www.pc120.net.cn/) [ad110.com](http://www.ad110.com/) [中国教程网](http://www.jcwcn.com/) [FIF多媒体制作组](http://fif.hlw.cn/) [金鹰电脑教程网](http://www.xjke.com/) [时代光魔](http://www.cybermagics.com/) [好好学习 天天向上](http://www.ttup.cn/)
[主编信箱](http://tech.163.com/special/d/00091M9L/draftad1.html)　热线:020-　[给网易提意见](http://bbs3.news.163.com/board/postlist.jsp?b=idea)　[About NetEase](http://corp.163.com/) - [公司简介](http://gb.corp.163.com/gb/about/overview.html) - [联系方法](http://gb.corp.163.com/gb/contactus.html) - [招聘信息](http://corp.163.com/gb/job/job.html) - [客户服务](http://gb.corp.163.com/gb/cs.html) - [相关法律](http://gb.corp.163.com/gb/legal.html) - [网络营销](http://emarketing.biz.163.com/) - [帮助中心](http://help.163.com/)
网易公司版权所有
©1997-2009
